% -*- root: main.tex -*-
\documentclass[11pt, twoside]{article}
\renewcommand{\baselinestretch}{1.1}
\usepackage[a4paper]{geometry}
\geometry{top=4cm, bottom=2.5cm, left=2cm, right=2cm} % Title

\usepackage{fancyhdr} % Customise style
% ERROR MEANS WE NEED TO GET RID OF EMPTY LINE \\'s
\setlength\parskip{\baselineskip}
\usepackage{hyperref}
\usepackage{url} % References
\usepackage{graphicx} % Show images
\usepackage[font=footnotesize,labelfont={footnotesize,footnotesize}, margin=0cm]{caption}
\usepackage{titlesec}
\usepackage{import} % Better version of include/input
\usepackage{listings} % Program code
\usepackage{float} % For better photo management
\usepackage{parskip} % Don't indent paragraphs
\usepackage{afterpage} % Blank pages
\usepackage{pgfgantt} % Gannt Charts
\usepackage{multirow} % Tables
\usepackage{tikz} % For diagrams
\usepackage{lscape} % For landscape
\usepackage{pifont} % Check marks
\newcommand{\cmark}{\ding{51}} % So we can use \cmark instead of \ding{51}
\newcommand{\xmark}{\ding{55}}
\usepackage{pgfplots} % Graphs
\usepackage{pdfpages} % For importing the title pdf page
 \usepackage[backend=bibtex,citestyle=numeric-comp,bibstyle=ieee]{biblatex}
% Use biblatex
\pgfplotsset{compat=1.12}
\hyphenchar\font=-1 % stop hypenation
\emergencystretch 3em
\addbibresource{chapters/bibliography}

\raggedbottom % Stop weird whitespace appearing because of twosided binding

\usetikzlibrary{shapes.geometric, arrows} % For diagrams

\newcommand\blankpage{ % Code for the blank page
    \null
    \thispagestyle{empty}
    \addtocounter{page}{-1}
    \newpage}

% Appendix items
\usepackage[toc,page]{appendix}

% Add title setup/style.
% \include{chapters/_title}

\begin{document}
    \pagenumbering{gobble} % Stop page numbering until we say again

    % For our custom title
    % \newgeometry{top=2.4cm, bottom=2.5cm, left=2.2cm, outer=2.2cm}
    % \maketitle
    % \newpage
    \includepdf[pages={1-},scale=1]{./resources/title-page.pdf}

    % Actual margins here
    \newgeometry{top=2.4cm, bottom=2.5cm, left=2.7cm, right=2.2cm}
    \import{./chapters/}{0_abstract}
    \newpage

    \import{./chapters/}{acknowledgements}

    % Actual margins here
    % TOC MARGINS
    \newgeometry{top=1.9cm, bottom=2.1cm, left=2.7cm, right=2.2cm}
    % END TOC MARGINS
    \tableofcontents
    \newpage
    \newgeometry{top=2.4cm, bottom=2.5cm, left=2.7cm, right=2.2cm}
    \blankpage
    % Set styles after the title, abstract and toc
    \fancypagestyle{plain} {
      \fancyhf{}
      \lhead[\rightmark]{\thepage}
      \rhead[\thepage]{\leftmark}
      \setlength{\parindent}{0pt}
      \setlength{\parskip}{2ex}
    }

    % Start page numbers
    \pagenumbering{arabic}

    \newgeometry{top=2.2cm, bottom=2.5cm, left=2.7cm, right=2.2cm}
    \import{./chapters/}{1_introduction.tex}
    \newgeometry{top=2.4cm, bottom=2.5cm, left=2.7cm, right=2.2cm}

    \import{./chapters/}{2_habit.tex}
    \import{./chapters/}{3_multimodal.tex}
    \import{./chapters/}{4_design.tex}
    \import{./chapters/}{5_implementation.tex}
    \import{./chapters/}{6_evaluation.tex}
    \import{./chapters/}{7_conclusion.tex}

    \cleardoublepage

    % Add bigger line spacing for each item
    \begingroup
        \renewcommand\bibname{References \vspace*{-10mm}}
        \scriptsize
        \setlength\bibitemsep{5pt}
        \printbibliography
    \endgroup

    \newgeometry{top=2.5cm,bottom=2.5cm} % set margins to be smaller so we can fit appendix items onto a single page

    \include{chapters/appendix}

\end{document}
